{
  "packages": ["llvm_15@15.0.7", "cassandra_4@4.1.2", "yq@3.2.2"],
  "env": {
    "L1X_CHAIN_TYPE": "beta_testnet",
    "CASSANDRA1_DATA": "./l1x-conf/cassandra1_data",
    "CASSANDRA2_DATA": "./l1x-conf/cassandra2_data",
    "CASSANDRA_HOST": "127.0.0.1",
    "CASSANDRA_PORT": "9042",
    "L1X_BUILD_CFG_ARTIFACTS_PATH": "$PWD/l1x-artifacts",
    "L1X_BUILD_CFG_CONTRACT_NAME": "l1x_ft",
    "L1X_BUILD_CFG_TOOLS_PATH": "$PWD/l1x-tools",
    "REPLICATION_ENABLED": "true",
    "RUST_LOG": "info",
    "VALIDATOR_PRIVATE_KEY_DEV": "6d657bbe6f7604fb53bc22e0b5285d3e2ad17f64441b2dc19b648933850f9b46",
    "VALIDATOR_PUBLIC_KEY_DEV": "0215edb7e9a64f9970c60d94b866b73686980d734874382ad1002700e5d870d945"
  },
  "shell": {
    "init_hook": ["echo 'Welcome to devbox!' > /dev/null"],
    "scripts": {
      "01_init_setup": [
        "echo Initializing Setup",
        "if [ ! -d $L1X_BUILD_CFG_ARTIFACTS_PATH ]; then mkdir $L1X_BUILD_CFG_ARTIFACTS_PATH; fi",
        "if [ ! -d $CASSANDRA1_DATA ]; then mkdir $CASSANDRA1_DATA; fi",
        "if [ ! -d $CASSANDRA2_DATA ]; then mkdir $CASSANDRA2_DATA; fi"
      ],
      "05_start_devnode": [
        "echo 'Start L1X devnode services...'",
        "devbox run 01_init_setup",
        "devbox services up"
      ],
      "06_stop_devnode": [
        "echo 'Stop L1X devnode services...'",
        "devbox services stop",
        "pkill server",
        "docker-compose -f docker-compose-cassandra-snitch.yml down",
        "echo 'Stop L1X devnode services... Done!!!'"
      ],
      "07_prune_devnode": [
        "echo 'Prune L1X devnode service resources...'",
        "docker-compose -f docker-compose-cassandra-snitch.yml down",
        "sudo rm -Rf $CASSANDRA1_DATA/*",
        "sudo rm -Rf $CASSANDRA2_DATA/*"
      ],
      "08_check_chain_state": [
        "echo 'Get L1X chain state...'",
        "cqlsh -e 'SELECT * FROM system.local;' $CASSANDRA_HOST $CASSANDRA_PORT",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "$L1X_BUILD_CFG_TOOLS_PATH/cli --endpoint $JSON_RPC chain-state"
      ],
      "10_compile": [
        "echo 'Compiling Contract $L1X_BUILD_CFG_CONTRACT_NAME ...'",
        "devbox run 01_init_setup",
        "./l1x-contracts/l1x-ft/build.sh",
        "cp target/wasm32-unknown-unknown/release/$L1X_BUILD_CFG_CONTRACT_NAME.wasm $L1X_BUILD_CFG_ARTIFACTS_PATH/.",
        "$L1X_BUILD_CFG_TOOLS_PATH/wasm-llvmir $L1X_BUILD_CFG_ARTIFACTS_PATH/$L1X_BUILD_CFG_CONTRACT_NAME.wasm",
        "$L1X_BUILD_CFG_TOOLS_PATH/build_ebpf.sh $L1X_BUILD_CFG_ARTIFACTS_PATH/$L1X_BUILD_CFG_CONTRACT_NAME.ll"
      ],
      "11_clean": ["cargo clean"],
      "12_deploy_contract": [
        "echo Deploying Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_SUPER=$(l1x-conf/get_dev_address.sh --dev super --type priv)",
        "echo super: $ACC_SUPER",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli --endpoint $JSON_RPC --private-key $ACC_SUPER submit-txn --payload-file-path l1x-conf/scripts/010-01-uc-ft-deploy.json"
      ],
      "13_init_contract": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_SUPER=$(l1x-conf/get_dev_address.sh --dev super --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_SUPER submit-txn --payload-file-path l1x-conf/scripts/010-02-uc-ft-init.json"
      ],
      "30_chk_balance_super": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_SUPER=$(l1x-conf/get_dev_address.sh --dev super --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_SUPER account-state"
      ],
      "31_chk_balance_ava": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_AVA=$(l1x-conf/get_dev_address.sh --dev ava --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_AVA account-state"
      ],
      "15_ft_token_balance_ava": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_AVA=$(l1x-conf/get_dev_address.sh --dev ava --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_AVA read-only-func-call --payload-file-path ./l1x-conf/scripts/010-03-uc-check-ava-balance.json"
      ],
      "16_ft_token_balance_bobby": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_BOBBY=$(l1x-conf/get_dev_address.sh --dev bobby --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_BOBBY read-only-func-call --payload-file-path ./l1x-conf/scripts/010-04-uc-check-bobby-balance.json"
      ],
      "17_ft_token_balance_emma": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_EMMA=$(l1x-conf/get_dev_address.sh --dev emma --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_EMMA read-only-func-call --payload-file-path ./l1x-conf/scripts/010-05-uc-check-emma-balance.json"
      ],
      "17_mint_ava_to_emma": [
        "echo Init Contract $L1X_BUILD_CFG_CONTRACT_NAME",
        "ACC_AVA=$(l1x-conf/get_dev_address.sh --dev ava --type priv)",
        "JSON_RPC_HOST=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key host_ip)",
        "JSON_RPC_PORT=$(l1x-conf/get_chain_config.sh --network $L1X_CHAIN_TYPE --conf-key rpc_port)",
        "JSON_RPC=http://$JSON_RPC_HOST:$JSON_RPC_PORT",
        "echo RPC endpoint: $JSON_RPC",
        "RUST_LOG=$RUST_LOG $L1X_BUILD_CFG_TOOLS_PATH/cli  --endpoint $JSON_RPC --private-key $ACC_AVA submit-txn --payload-file-path ./l1x-conf/scripts/010-20-uc-mint-ava-to-emma.json"
      ]
    }
  }
}
